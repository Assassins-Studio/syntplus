<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>synt+</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet" />
<style>
  /* Reset and base */
  body, html {
    margin: 0; padding: 0; height: 100vh;
    background: #121212;
    color: #eee;
    font-family: 'Roboto Mono', monospace;
    display: flex; flex-direction: column;
    overflow: hidden;
  }
  /* Loading Screen */
  #loading-screen {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #121212;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: #00bcd4;
    font-size: 2rem;
    z-index: 9999;
    transition: opacity 0.8s ease;
  }
  #loading-screen.hidden {
    opacity: 0;
    pointer-events: none;
  }
  /* Spinner */
  .spinner {
    border: 5px solid #00bcd440;
    border-top: 5px solid #00bcd4;
    border-radius: 50%;
    width: 60px; height: 60px;
    animation: spin 1s linear infinite;
    margin-bottom: 20px;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  header {
    background: #1e1e1e;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    border-bottom: 2px solid #00bcd4;
    z-index: 1;
  }
  .logo {
    font-weight: bold;
    font-size: 1.4rem;
    color: #00bcd4;
  }
  nav button {
    margin-left: 10px;
    background: #2979ff;
    border: none;
    color: white;
    padding: 6px 14px;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
  }
  nav button:hover {
    background: #00bcd4;
  }
  #language-select {
    margin-left: 20px;
    background: #222;
    color: #eee;
    border: none;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
  }
  main {
    flex: 1;
    display: flex;
    overflow: hidden;
  }
  #editor, #console {
    flex: 1;
    height: 100%;
    border: none;
    outline: none;
  }
  #editor {
    background: #1e1e1e;
  }
  #console {
    background: #121212;
    color: #00e676;
    padding: 10px;
    font-size: 0.9rem;
    overflow-y: auto;
    white-space: pre-wrap;
  }
  footer {
    background: #1e1e1e;
    padding: 8px 20px;
    text-align: center;
    color: #666;
    font-size: 0.85rem;
  }
</style>
</head>
<body>

<div id="loading-screen" aria-live="polite" aria-busy="true" role="alert">
  <div class="spinner"></div>
  Welcome to synt+
</div>

<header>
  <div class="logo">synt+</div>
  <nav>
    <button id="new-file-btn">New File</button>
    <button id="open-file-btn">Open File</button>
    <button id="save-file-btn">Save File</button>
    <select id="language-select" title="Select Language">
      <option value="javascript" selected>JavaScript</option>
      <option value="python">Python (syntax only)</option>
      <option value="cpp">C++ (syntax only)</option>
      <option value="csharp">C# (syntax only)</option>
    </select>
  </nav>
</header>

<main>
  <div id="editor" tabindex="0"></div>
  <div id="console" aria-live="polite" aria-atomic="true"></div>
</main>

<footer>synt+ â€” simple web-based code editor | Running JavaScript only</footer>

<input type="file" id="file-input" accept=".synt" style="display:none" />

<!-- Monaco Editor loader -->
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.38.0/min/vs/loader.js"></script>
<script>
  let editor;
  const consoleEl = document.getElementById('console');
  const languageSelect = document.getElementById('language-select');
  const newFileBtn = document.getElementById('new-file-btn');
  const openFileBtn = document.getElementById('open-file-btn');
  const saveFileBtn = document.getElementById('save-file-btn');
  const fileInput = document.getElementById('file-input');
  const loadingScreen = document.getElementById('loading-screen');

  function clearConsole() {
    consoleEl.textContent = '';
  }

  function consoleLog(msg, isError = false) {
    const span = document.createElement('span');
    span.textContent = msg + '\n';
    span.style.color = isError ? '#ff5370' : '#00e676';
    consoleEl.appendChild(span);
    consoleEl.scrollTop = consoleEl.scrollHeight;
  }

  function runCode() {
    clearConsole();
    if (languageSelect.value !== 'javascript') {
      consoleLog(`Execution only supported for JavaScript. Selected: ${languageSelect.value}`, true);
      return;
    }
    const code = editor.getValue();
    try {
      consoleLog('Running JavaScript code...');
      let result = eval(code);
      if (result !== undefined) {
        consoleLog(String(result));
      }
    } catch (err) {
      consoleLog(err.message || err.toString(), true);
    }
  }

  require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.38.0/min/vs' } });
  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(document.getElementById('editor'), {
      value: '// Write your JavaScript code here\n',
      language: 'javascript',
      theme: 'vs-dark',
      fontFamily: "'Roboto Mono', monospace",
      fontSize: 14,
      automaticLayout: true,
      minimap: { enabled: false },
      scrollBeyondLastLine: false,
    });

    // After editor ready, fade out loading screen smoothly
    setTimeout(() => {
      loadingScreen.classList.add('hidden');
      setTimeout(() => loadingScreen.style.display = 'none', 900);
    }, 1500); // keep loading visible for 1.5s

    languageSelect.addEventListener('change', (e) => {
      const lang = e.target.value;
      monaco.editor.setModelLanguage(editor.getModel(), lang);
      clearConsole();
      editor.setValue(`// Language: ${lang}\n`);
    });

    newFileBtn.addEventListener('click', () => {
      editor.setValue('');
      clearConsole();
    });

    openFileBtn.addEventListener('click', () => fileInput.click());

    fileInput.addEventListener('change', (e) => {
      if (!e.target.files.length) return;
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = () => {
        editor.setValue(reader.result);
        clearConsole();
      };
      reader.readAsText(file);
      fileInput.value = '';
    });

    saveFileBtn.addEventListener('click', () => {
      const code = editor.getValue();
      const blob = new Blob([code], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'code.synt';
      a.click();
      URL.revokeObjectURL(a.href);
    });

    // Run code on Ctrl+Enter
    editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {
      runCode();
    });

    consoleLog('Press Ctrl+Enter to run JavaScript code.\n');
  });
</script>

</body>
</html>
